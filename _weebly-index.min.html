<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>Weebly</title></head><body><link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"><style media="screen">input::placeholder{color:#757575}.input-field label,.input-field span,input[type=text]:not(.browser-default).validate+label,input[type=text]:not(.browser-default):disabled,input[type=text]:not(.browser-default):disabled+label{color:#000}#stat,input[type=text]:not(.browser-default).invalid,input[type=text]:not(.browser-default).invalid:focus,input[type=text]:not(.browser-default).invalid:focus~.helper-text[data-error],input[type=text]:not(.browser-default).invalid~.helper-text[data-error]{color:#d50000}.input-field input[type=text].valid{border-bottom:1px solid #1b5e20;box-shadow:0 1px 0 0 #1b5e20}.input-field input[type=text].invalid{border-bottom:1px solid #d50000;box-shadow:0 1px 0 0 #d50000}.input-field>label{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;font-size:1.35em}.l0{display:none!important}.button-center{margin:auto;display:block}.box{background-color:rgba(255,255,255,.8);border-radius:30px}</style><div class="row box"><br><form class="col s12" id="input"><div class="input-field col s12 m4"><input placeholder="Lorem" id="fname" type="text" class="validate" required disabled> <label for="fname">First Name</label></div><div class="input-field col s12 m4"><input placeholder="Ipsum" id="lname" type="text" class="validate" required disabled> <label for="lname">Last Name</label></div><div class="input-field col s12 m4"><input placeholder="010123449" id="id" type="text" class="validate" pattern="[0-9]{9}" required disabled> <label for="id">Student ID</label> <span class="helper-text" data-error="The input is not a 9-digit number"></span></div><div class="input-field col l0"><input placeholder="Pass" id="pass" type="text" class="validate" pattern=".*" autocomplete="off" disabled> <label for="pass">Pass</label></div><div class="col s12"><button class="btn waves-effect waves-light cyan darken-2 button-center" id="submit" type="submit" name="action" disabled>Submit<i class="material-icons right">send</i></button><br></div></form><form class="col s12"><div class="input-field col s12 m4"><input placeholder="(Press Submit)" id="serv" type="text" disabled> <label for="serv">Service Hours</label></div><div class="input-field col s12 m4"><input placeholder="(Press Submit)" id="lead" type="text" disabled> <label for="lead">Leadership Hours</label></div><div class="input-field col s12 m4"><input placeholder="(Press Submit)" id="fell" type="text" disabled> <label for="fell">Fellowship Hours</label></div><div class="input-field col s12"><input placeholder="JavaScript is not Enabled! Cannot Talk to the Server!" id="stat" type="text" disabled> <label for="stat">Query Status</label></div><div class="input-field col s12" id="data"></div></form></div><script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script><script>"use strict";function putInStat(e,t){let n=byId("stat");n.style.color=t,n.value=e}function checkForm(){if(!form||ins.some(e=>!e))return err(str.malfunc),window.location.reload(!0),!1;for(let e of ins)e.focus();return form.checkValidity()?parseInt(byId("id").value)%13==11||(byId("id").focus(),err(str.invstid),!1):(err(str.invinpt),!1)}function submitData(e){let t=ins.reduce((e,t)=>(e[t.id]=t.value.trim().toLowerCase(),e),{});return postFetch(e,t)}function excelDate(e){let t;if(e>60)t=25568;else{if(!(e>0&&e<60))return e.toString();t=25567}let n=new Date(86400*(e-t)*1e3);return`${n.getMonth()+1}/${n.getDate()}/${n.getFullYear()}`}function dateRange(e){let t=e.replace(/\s/g,"").split("-"),n=t.map(e=>{let t=e.split("/");return 3===t.length&&2===t[2].length&&(t[2]=`20${t[2]}`),t.join("/")});return n.join(" - ")}function parseResponse(e){for(let t of outs)t.value=numFormat(e[t.id]);const t=e.data,n=document.createElement("table"),r=document.createElement("thead");let o=document.createElement("tr");for(let e of["Date","Event","S","L","F"]){let t=document.createElement("th"),n=document.createTextNode(e);t.appendChild(n),o.appendChild(t)}r.appendChild(o),n.appendChild(r);const a=document.createElement("tbody");for(let e of t){let t,n=document.createElement("tr");t="number"==typeof e.date?excelDate(e.date):dateRegex.test(e.date)?dateRange(e.date):e.date;let r=document.createElement("td"),o=document.createTextNode(t);r.appendChild(o),n.appendChild(r),r=document.createElement("td"),o=document.createTextNode(e.event),r.appendChild(o),n.appendChild(r);for(let t of[e.serv,e.lead,e.fell])r=document.createElement("td"),t&&(o=document.createTextNode(numFormat(t)),r.appendChild(o)),n.appendChild(r);a.appendChild(n)}n.appendChild(a),tblDiv.appendChild(n),suc(str.success)}function search(){for(let e of outs)e.value="";for(;tblDiv.lastChild;)tblDiv.removeChild(tblDiv.lastChild);if(checkForm()){war(str.loading);for(let e of outs)e.value=str.checkin;submitData(`http://${ip}/php/search.php`).then(e=>{if(200===e.status)return e.json();err("Internal Error!")}).then(e=>{for(let e of outs)e.value="";switch(e.stat){case-1:return void err(str.notfond);case-2:return void err(str.reqerrr);case-3:return void err(str.updatin);case 0:return void parseResponse(e);default:return void err(str.interrr)}}).catch(errCon)}}function time(){getFetch(`http://${ip}/php/search.php`).then(e=>{if(200===e.status){suc(str.testres);for(let e of ins)e.disabled=!1;submit.disabled=!1,submit.addEventListener("click",e=>{e.preventDefault(),search()}),document.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),search())}),byId("fname").focus()}else errCon()}).catch(errCon)}function init(){war(str.testing),getFetch(ipUrl).then(e=>{if(200===e.status)return e.text();errCon()}).then(e=>{ip=`${e.trim()}:38080`,time()}).catch(errCon)}const str={timeout:"Connection failure! Please retry in a few moments...",testres:"Ready for query",malfunc:"Webpage malfunction! Reloading...",invinpt:"Invalid input!",invstid:"You may have mistyped your student ID. Please double check.",success:"Success",loading:"Searching data...",checkin:"Checking...",notfond:"Name-ID combination not found!",reqerrr:"Request error!",updatin:"Server is updating data. Please retry in a few moments...",interrr:"Internal error!",testing:"Looking for server..."};var ip;const ipUrl="https://mushinako.github.io/Check-Hours/ip.txt",dateRegex=/^\d{1,2}\/\d{1,2}\/\d{2,4}\s*\-\s*\d{1,2}\/\d{1,2}\/\d{2,4}$/,byId=e=>document.getElementById(e),inputsFromIds=e=>e.map(e=>byId(e)),tblDiv=byId("data"),form=byId("input"),submit=byId("submit"),ins=inputsFromIds(["fname","lname","id","pass"]),outs=inputsFromIds(["serv","lead","fell"]),suc=e=>putInStat(e,"#1b5e20"),war=e=>putInStat(e,"#f57f17"),err=e=>putInStat(e,"#d50000"),errCon=()=>err(str.timeout),numFormat=e=>(Math.round(100*e)/100).toFixed(2),getFetch=e=>fetch(e,{method:"GET"}),postFetch=(e,t)=>fetch(e,{method:"POST",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Object.entries(t).map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&")});document.addEventListener("DOMContentLoaded",()=>{let e=["  ___________  ____   ___    _______ ______"," / ___/ __/ / / / /  / _ )  / ___/ //_/  _/","/ /___\\ \\/ /_/ / /__/ _  | / /__/ ,< _/ /","\\___/___/\\____/____/____/  \\___/_/|_/___/",""," Bug Reports Welcomed!"];console.log(e.join("\n")),init()});</script></body></html>